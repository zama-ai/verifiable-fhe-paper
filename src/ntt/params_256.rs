pub const N: usize = 256;
pub const LOGN: u32 = 8;
pub const NINV: u64 = 18374686475393433601;

pub const ROOTS: [u64; 256] = [1, 281474976710656, 18446744069397807105, 18446742969902956801, 17293822564807737345, 4096, 4503599626321920, 18446744000695107585, 70368744161280, 18446744068340842497, 64, 18014398509481984, 4398046511104, 288230376084602880, 18446744052234715141, 262144, 549755813888, 36028797010575360, 9223372032559808513, 32768, 8, 2251799813685248, 18446744069280366593, 18446735273321564161, 18446744069412487169, 18446743931975630881, 35184372088832, 2305843008676823040, 562949953290240, 18446744060824649729, 512, 144115188075855872, 17870292113338400769, 576469548262227968, 18446744035054321673, 18446744035055370249, 18410715272395620481, 36028797018964096, 140735340838912, 18446603329778778113, 2198989700608, 18446741870357774849, 562949953421314, 562949953421310, 9007336691597312, 9007061813690368, 16140901060200898561, 2305843009213702144, 1125917086449664, 1125882726711296, 18158513693262873601, 288230376151712768, 13835128420805115905, 4611756386097823744, 18446743794532483137, 18446743794540871745, 18446744065119551490, 18446744065119682562, 72058693532778496, 72056494509522944, 17591917604864, 18446726476960108545, 4503599627370512, 4503599627370480, 13797081185216407910, 13664737158269917819, 14004640413449681173, 17534372342291866343, 15104850399680027611, 10467450029535024137, 10832292272906805046, 12079821679951430619, 3051558327610197629, 10853271128879547664, 16016224591364643153, 7546206866789277329, 1654663398520981866, 10737174897695903067, 7479733969963382412, 5834015391316509212, 14041890976876060974, 12871361905596103084, 10158338780952714962, 9952623958621855812, 18142929134658341675, 17084176919086420947, 1356658891109943458, 11147770252432840497, 8668109077711679267, 4497639551463306333, 13237307188167854928, 12110422903908887252, 5965722551466996711, 13039192753378044028, 17449332314429639298, 5029422726070465669, 281721071064741919, 6336932523019185545, 3291437157293746400, 8180754653145198927, 16940035449150731648, 10231374777478672322, 9362914843564906265, 15603425602538700070, 11387280211730213981, 7737793303239342069, 18030148548143482816, 18182056015521604139, 15951685255325333175, 8930739766887302688, 14251112719600934854, 9171943329124577373, 4299803665592489687, 1116342470860912836, 6393075107303762937, 8064021942171041292, 2253768568517935352, 13801972045324315718, 7884753188935386879, 10105805016917838453, 411429644661718300, 3328437340319972906, 16933017626115159474, 16105685926854668541, 17311265416183374564, 6562114217670983589, 15113979899245772281, 16329239638270742865, 1803076106186727246, 17255643403020241594, 15387314553928353233, 13754189079328553053, 8807895225777549048, 6702103175001071216, 17644663131801795567, 12362671770314801832, 5175614254872652016, 7110695772441637899, 4716406379463037818, 16003277697834987077, 1999001684679808555, 4007052201025272707, 10302972367325609442, 4659489603533118441, 11779090253969091270, 12030096568512274289, 15122929597976639421, 16723337261179401086, 14424608849493817968, 8917938738259842505, 12418052014939319938, 17799792287555502819, 18064315379978805435, 8636802660946538252, 15992013477438468440, 13609673538787597335, 4511425900152047486, 1545333971289350229, 837762896875133902, 17345757166192390690, 14430643036723656017, 12012107771410162524, 11286965527584982002, 11478179872302871445, 14319745502085270124, 4545880015766881148, 6125875985213995509, 3870163035137971766, 3266250949199600360, 2942775058270059609, 1223950879584769038, 12458390524252444375, 10563982722973987470, 4674437595989441835, 12573252732142656207, 14235159967861628657, 5932183857725394514, 12113519742882795430, 3877499600194655066, 17920296056720464863, 4764679877301742210, 3863141824208378587, 16508747943021518732, 18038462700764634276, 15245928743009060991, 8352301510068328051, 10724885506133562476, 502012629086366038, 7683263524182218559, 5095456396745892551, 9791607036678152304, 7433403846946633395, 13413385849078745835, 17746383299198219332, 11706055037741049324, 7562975036722005970, 9432384046970425189, 6824599109910832222, 12584286203165206160, 4913598178833380825, 14031687523985394587, 11317759638843783896, 9906467147968854674, 10517142914396393667, 17571109804126144978, 12184322017746068437, 13376768784840513824, 12499229437757822825, 16031446777576706363, 8440569278248727675, 1672096098105064228, 17703304740457489134, 15073366445557045075, 12843857907683664409, 1414719954855472987, 5163568085532294797, 10686628914424923326, 14780429931651188987, 11441669947107069577, 5240855794895625891, 1573035775395650770, 16755100833091933884, 5464760906092500108, 10350167037512812052, 10773575572760153082, 4170631435500673867, 1755078694165381998, 14858508306367504656, 17225392536559506335, 3953731985901328040, 13805406186829188324, 13018888299131362939, 8286160002038086708, 1644572010096941946, 6979306088310177371, 8665994900238946994, 15341376048663650670, 16549024694582589649, 14067222244347930501, 13231174195295398387, 6529358023436602414, 18209529147560584987, 8675931806573960433, 13183111817796039999, 12401628304422887372, 14918307414590806615, 14040629553323055984, 8187602034452531322, 4831070854124318830, 1857313538295938082, 12050543972821699434, 3264989070758626945, 10949047808060940701, 13156576080775535568, 494216498237666005, 13987726993667822989];

pub const INVROOTS: [u64; 256] = [1, 18446462594437873665, 1099511627520, 16777216, 68719476736, 18442240469788262401, 18446744069414580225, 1152921504606846976, 18446744069414322177, 17179869180, 18158513693329981441, 18446739671368073217, 18428729670905102337, 18446744069414584257, 1073741824, 18446673700670423041, 18302628881338728449, 18446744069414583809, 8589934592, 18446181119461294081, 16140901060737761281, 18446708885042495489, 137438953440, 2097152, 8796093020160, 134217728, 18444492269600899073, 18446744069414584313, 18446744069414551553, 9223372036854775808, 18410715272404008961, 18446743519658770433, 18442240469787213841, 18442240469787213809, 17592454475776, 18446726477496979457, 18374687574905061377, 18374685375881805825, 4294901759, 4295032831, 274873712576, 274882101184, 13834987683316760577, 4611615648609468416, 18158513693262871553, 288230376151710720, 18445618186687873025, 18445618152328134657, 16140901060200882177, 2305843009213685760, 18437737007600893953, 18437736732722987009, 18446181119461163011, 18446181119461163007, 2199056809472, 18446741870424883713, 140739635806208, 18446603334073745409, 18410715272395620225, 36028797018963840, 34359214072, 34360262648, 17870274521152356353, 576451956076183552, 2117504431143841456, 3332764170168812040, 11884629851743600732, 1135478653231209757, 2341058142559915780, 1513726443299424847, 15118306729094611415, 18035314424752866021, 8340939052496745868, 10561990880479197442, 4644772024090268603, 16192975500896648969, 10382722127243543029, 12053668962110821384, 17330401598553671485, 14146940403822094634, 9274800740290006948, 4195631349813649467, 9516004302527281633, 2495058814089251146, 264688053892980182, 416595521271101505, 10708950766175242252, 7059463857684370340, 2843318466875884251, 9083829225849678056, 8215369291935911999, 1506708620263852673, 10265989416269385394, 15155306912120837921, 12109811546395398776, 18165022998349842402, 13417321343344118652, 997411754984945023, 5407551316036540293, 12481021517947587610, 6336321165505697069, 5209436881246729393, 13949104517951277988, 9778634991702905054, 7298973816981743824, 17090085178304640863, 1362567150328163374, 303814934756242646, 8494120110792728509, 8288405288461869359, 5575382163818481237, 4404853092538523347, 12612728678098075109, 10967010099451201909, 7709569171718681254, 16792080670893602455, 10900537202625306992, 2430519478049941168, 7593472940535036657, 15395185741804386692, 6366922389463153702, 7614451796507779275, 7979294039879560184, 3341893669734556710, 912371727122717978, 4442103655964903148, 4782006911144666502, 4649662884198176411, 4459017075746761332, 17952527571176918316, 5290167988639048753, 7497696261353643620, 15181754998655957376, 6396200096592884887, 16589430531118646239, 13615673215290265491, 10259142034962052999, 4406114516091528337, 3528436654823777706, 6045115764991696949, 5263632251618544322, 9770812262840623888, 237214921853999334, 11917386045977981907, 5215569874119185934, 4379521825066653820, 1897719374831994672, 3105368020750933651, 9780749169175637327, 11467437981104406950, 16802172059317642375, 10160584067376497613, 5427855770283221382, 4641337882585395997, 14493012083513256281, 1221351532855077986, 3588235763047079665, 16691665375249202323, 14276112633913910454, 7673168496654431239, 8096577031901772269, 12981983163322084213, 1691643236322650437, 16873708294018933551, 13205888274518958430, 7005074122307514744, 3666314137763395334, 7760115154989660995, 13283175983882289524, 17032024114559111334, 5602886161730919912, 3373377623857539246, 743439328957095187, 16774647971309520093, 10006174791165856646, 2415297291837877958, 5947514631656761496, 5069975284574070497, 6262422051668515884, 875634265288439343, 7929601155018190654, 8540276921445729647, 7128984430570800425, 4415056545429189734, 13533145890581203496, 5862457866249378161, 11622144959503752099, 9014360022444159132, 10883769032692578351, 6740689031673534997, 700360770216364989, 5033358220335838486, 11013340222467950926, 8655137032736432017, 13351287672668691770, 10763480545232365762, 17944731440328218283, 7721858563281021845, 10094442559346256270, 3200815326405523330, 408281368649950045, 1937996126393065589, 14583602245206205734, 13682064192112842111, 526448012694119458, 14569244469219929255, 6333224326531788891, 12514560211689189807, 4211584101552955664, 5873491337271928114, 13772306473425142486, 7882761346440596851, 5988353545162139946, 17222793189829815283, 15503969011144524712, 15180493120214983961, 14576581034276612555, 12320868084200588812, 13900864053647703173, 4126998567329314197, 6968564197111712876, 7159778541829602319, 6434636298004421797, 4016101032690928304, 1100986903222193631, 17608981172539450419, 16901410098125234092, 13935318169262536835, 4837070530626986986, 2454730591976115881, 9809941408468046069, 382428689435778886, 646951781859081502, 6028692054475264383, 9528805331154741816, 4022135219920766353, 1723406808235183235, 3323814471437944900, 6416647500902310032, 6667653815445493051, 13787254465881465880, 8143771702088974879, 14439691868389311614, 16447742384734775766, 2443466371579597244, 13730337689951546503, 11336048296972946422, 13271129814541932305, 6084072299099782489, 802080937612788754, 11744640894413513105, 9638848843637035273, 4692554990086031268, 3059429515486231088, 1191100666394342727, 16643667963227857075];

// Test Vectors

pub const TESTG: [u64; 256] = [13204243775913477834, 2800763767723671355, 5360417149922970318, 2397651503325674102, 7888153878270625030, 9899592280867565868, 12634018147418232028, 14655429898838239886, 13369381709363964819, 4668206305484011983, 12225199350891239879, 11051352692548611730, 17211813450236295274, 11927736204979070430, 13810426481697823891, 11714663767135590298, 2466223959026532011, 7730560632174300801, 9246276099231957853, 12469016465691045798, 14211138956836766170, 3036464751975575845, 14701469487456807805, 8420048554737822641, 8110574484536145238, 5379388459032558405, 8281760839624987445, 3504353815840335095, 5519745986245182181, 15226831072075535947, 11697067921854517809, 6793295779709632909, 10296397527953563740, 11098189026300607158, 15934723605274784849, 1608139986815274069, 1008820766792606397, 2687311540905312359, 6531307036816914242, 4186108671033972066, 18394508276345778115, 17702316727573624955, 3479973854806414042, 8402075424898206686, 1101244979058016392, 4819292629454911355, 3684182738186398783, 15760419811389981909, 3150252760295797605, 12525652030907569044, 17515663228093137477, 15726533388136311096, 18073546129414474747, 1456535184455077510, 2289924930099628460, 3522944029789430, 16388262088117784749, 9387464497550486997, 5920111402000065044, 2301112752426888052, 17929705372770651569, 9920424257720582979, 13170028865559897141, 6395569574232069520, 5835417492984593590, 13718109052755475614, 12724494441039848322, 5423725725122424770, 12235135966455403965, 11204245908864186654, 13244222762703595342, 10317115835757428787, 16168866636792960803, 3686061663226626652, 9582448978006778890, 6772056246374344087, 3360944947255750452, 6659828897900370618, 4816247091203814034, 6468304296940001974, 7533530240459765526, 10727853074088667331, 15806691656885524420, 12338011056758692620, 3099370249055367343, 1993826314838822199, 9908078571363012849, 5032152284915038411, 4689379013628088356, 7077225404530898934, 13157232333860722497, 15529629240308177276, 7190528139276268432, 11339764906973630852, 14353381952722601881, 1838892020634277333, 10618601352954768098, 12080342312683800848, 7003017075894653251, 12116521998212826663, 6316458075844288925, 11868787601054721133, 5229078963411153817, 1549836631774880813, 5198408877842688363, 14248954194006306156, 6373310057322876833, 18081846002813989923, 4252539205387753445, 14223221961410393919, 10140711979725969796, 2270089996191483998, 744109516123073753, 13911057573764949876, 133288097191340193, 13512101922404297202, 17671318217675494507, 3353861410942095128, 10554999835065309806, 6116801696815373980, 11732092188181262306, 17549197973256773677, 5498264492892322599, 11350653959030521179, 10517755466834498022, 12361177229640069335, 17452786177446027590, 402309290342242046, 3649914227235039510, 12929857503068832093, 1695801977751427112, 11840624323312826118, 13194185899261855663, 13587794487579028737, 6463419687855643740, 8315313800225818417, 5358890113022957272, 17772454476411218234, 1665490059592181826, 17803305648497345759, 15625435143908752874, 13976133182663415672, 2382450363712788936, 9429875321465469184, 687412235765135284, 7122343250006862158, 2276974577319405985, 10930665125076280902, 8470467609657019627, 14506035776686444359, 18393962752595537341, 4039876340580804969, 14752077896846109374, 16014786973693752244, 2873429207290186999, 8440479808898828391, 626176681926871717, 13259744549787301326, 2224015713736086416, 3225688970188656318, 12443762872177123494, 14011193495570064777, 15569095798264576804, 2858943813989508742, 17675574647767397766, 6175734096780507167, 11076477806424101304, 14479966059875294185, 15411616048613211613, 1701675494420804847, 5045670761879761246, 11987487799630027933, 1946487566000103158, 11068812830398556640, 7158366342480077874, 8961925269437589060, 9888066728230371905, 7950837180276987374, 2323943450637407423, 15932038822088168179, 6383469555967097820, 3069296059601079815, 17167547783180690615, 4533395258905050341, 15482773075737737001, 7634858817165894133, 9603067036668698183, 14316272636601081703, 4595340217385739660, 3499544944534163113, 9238104523776840914, 6988632016713383965, 11121398054919954153, 16412319669891016339, 15402534369446799896, 240832160098728382, 10440733225449985006, 3519617637411153343, 16067414473563034845, 201639370416233001, 13485899474557062606, 9325012354965266831, 6570133567478943760, 9094107303145531250, 4841216187677550210, 17337382144217154381, 866899186258831913, 17803425165446661866, 514796162786117568, 7793244463464147543, 1616601083000318948, 11178635722909022350, 1062714012480505154, 14648589145580361319, 12115624580508999530, 8412511914784854772, 11164031239823158140, 6811347731882785261, 13226289658924576644, 16750893855022954065, 3494000848818106162, 15431884017588979204, 924889368390742914, 9420890314865006930, 4250681132757733137, 11980131268765669165, 8238703417365120903, 6546243739708862218, 466523226462990629, 13760688176171536258, 7842156929734736110, 14610797893255089368, 11788524329318300828, 17557286925009109628, 7089461501844809697, 16022640756275115804, 10435665779909634756, 7937596081052286724, 15359793540166190501, 11657845220022454758, 3888645712709683838, 4288285511716349509, 6834746336641599968, 2607713197401602702, 11556023699138448526, 8970352332724473994, 5412361273787340741, 2662274262602941200, 2832453664122764139, 6558720800270404886, 961915809760946079, 1364329621561332154, 600329822116143606, 9288934866057521712, 655163146698333232, 1245621666480845536];

pub const TESTGHAT: [u64; 256] = [13634877319328081, 6558615844857859074, 1809791551149111410, 16489091164032662934, 18402887611583451852, 14813221095065423540, 2326643161656586433, 13652656964142002480, 18160252826778214454, 14264047787043424029, 2505923965092591657, 13495585856810215463, 2878889564586906152, 9418984239929958070, 649434406894913389, 4373300666290224969, 14125243460536769905, 695890717043471038, 7417803323928400591, 7562974847457187156, 11536000077817112427, 1298483455965766198, 14187040216458275402, 12840280052602134027, 12927429902970129923, 4649941598353538126, 13067050908864819517, 16610018078305910526, 18414997582961576446, 7826269620587030461, 3619171756729725179, 13216052715835570721, 14401170862525996840, 3605999094090264079, 1649283175226041389, 199700561946747873, 7434700226350485085, 3615596082892658071, 15932424100682528387, 7149098754650193229, 6719599282135966123, 10991012422177903472, 1398276043376666907, 15495421852698516348, 12210069263780831580, 8685691515070093278, 1037764295918944936, 9439857637865380650, 5232331612311777009, 12549811940491108183, 10549986249624973481, 12477081419728001363, 10573313940095085130, 15318561578813650625, 15198161315361220494, 10325996386143526015, 17122492291670217087, 3096153238607607335, 5857092213907293211, 10581669545581144561, 3879404157451785132, 14478843298651217171, 7044972736576998702, 4317766835934315666, 3847964010408480593, 12739163422054879822, 16949062486297932162, 10130255430152388670, 13859124249164960805, 7403342806755439828, 11644735861500894843, 13236685593792756402, 2137377473912329228, 2312102783180832095, 17899902601323707802, 15506504462641115936, 14943156216408926446, 14149102962680205102, 7154582440493351964, 1415658965863032028, 4925536253920197191, 5929407472378939518, 16563528212619339560, 14364340860864942475, 14706853033218271535, 15534895319090214636, 1340426988450340694, 17624198621037033183, 14514906395524883803, 5799547366911877489, 6542680758896828585, 9484094565287183582, 3759964384251621690, 17614167834519597331, 4781855236546351190, 7557614722115062866, 16119738255675559297, 10923466595439156719, 16132971961890105151, 364057209741261332, 4384429531174289924, 10185553295105987584, 15486305651859662401, 12468054461821693130, 13257957815750781522, 7023185471605362185, 12364523039560748658, 15705653777140300093, 5624010208669844880, 1381978948098529997, 12671866606721890548, 14299916646089643904, 361612678996958087, 15939525516237237234, 6391843120388213520, 5780863298578994813, 17473267420982495233, 9183991702864399453, 6878889894546160068, 15440870004425735444, 9505218775259804437, 11681906592647161200, 273433838403133369, 18135916447256196572, 1782218839995892059, 7300673237209039021, 4917382042120364160, 13139465938669233770, 5850056397447795524, 7160855273982436208, 12787671743645277472, 4096821983000517312, 9307878580998171986, 10453293352150514975, 6092171207662228396, 3086586285376750455, 7688927845049225605, 2987056075204172672, 1620891997952229795, 13070867303694608967, 982804608201839473, 8682309985928013482, 6508295940466006844, 7284298011299222156, 6246242620259182278, 8023296059938265866, 14927751514520931664, 17571836752961276248, 8657355787671442893, 15855985704442154578, 14470884486117279969, 8951930076450344462, 9431378781370602637, 2350553114637878609, 242002312469354498, 902840098118954830, 4967838017460575826, 2491637027957026345, 15470801020102616501, 16303133119063843952, 1154207414412091935, 14999591619296249308, 4064315092694853597, 10675461540796022168, 18277251369696546495, 2953121066492712513, 16869125293599955213, 17095363382417830171, 1111770081427362345, 10404057261987422817, 1239686882150208846, 17139794623181187451, 17273691667352942335, 1017244123036748941, 16736453617795991469, 7727705188473321030, 14419979634043523241, 2295411503552806342, 1612804815213677309, 13161207297416938723, 5770718592237319526, 9313221274691792305, 5326568307511940856, 8682370197821532727, 904694524245301364, 437121740882268888, 10109784827174169425, 13145604836921230416, 10848544727838769014, 16046739710571723314, 8970659933179627852, 9684943351886008022, 18238507255290408721, 17623232608753868165, 17026925968723780853, 16747409505578225786, 15053701824515036387, 1020342008914545504, 1378065489499210659, 1352845701959334869, 4766838600000812803, 13144860105916474975, 14496339434152586242, 16868823490532357739, 12028576507487002533, 1608237994684055790, 15199351344817965011, 15847985497005829722, 208921679543600908, 2741443998484837581, 17242064063271600952, 3335242910326325264, 9233771679596656541, 351013640244215413, 498347741558035834, 13061644346536337335, 10754370489393530558, 6715092230286207355, 2447786839697038732, 5051678473993730571, 18003461104375435896, 1391146330207473161, 12237868023793111282, 2322115521326297406, 4890992641605232411, 6131799934059467536, 8246492694310307407, 1723383762552878250, 7524822963767392549, 1460263021338478580, 1655500735066955337, 6510204966382998002, 14022668358796755165, 11757930039511931684, 13803791843178181634, 8406578297937415123, 17674390879559163992, 3112278935957728212, 9007014470211670690, 16930521910111837760, 2787385027087893795, 2425122044175951153, 8638835793989645040, 2622141588549550320, 10822757156627745244, 14820226185583554130, 9939488979745301339, 10777345704939008263, 1635115684012584449, 7371353623329704746, 18334870780233640825, 4283332591038735053, 15340903143094644267, 5568137274492936575, 13677950796950384938, 17594509403773409893];

